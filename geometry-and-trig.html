<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<link rel="stylesheet" href="style.css">
<title>Geometry and Trig</title>

<script type="text/x-mathjax-config">
  // awesome, i have javascript inside html inside python
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX", "output/HTML-CSS"],
    tex2jax: {
      inlineMath: [ ['$','$'] ],
      displayMath: [ ['$$','$$'] ],
    },
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js"></script>
</head>
<body>
<div id="content">
<div id="sidebar"><div class="sidebarblock"><h3>Interesting for programmers</h3><ul><li><a href="infinity.html">Infinity</a></li><li><a href="numbertheory.html">Number Theory</a></li><li><a href="fib.html">Fibonacci Sequence</a></li><li><a href="derivatives.html">Derivatives</a></li><li><b>Geometry and Trig</b></li></ul></div><div class="sidebarblock"><h3>Kinda fun</h3><ul><li><a href="integrals.html">Integrals</a></li><li><a href="more-integrals.html">More Integrals</a></li></ul></div><div class="sidebarblock"><h3>Mathy</h3><ul><li><a href="more-derivatives.html">More Derivatives</a></li><li><a href="more-geometry-and-trig.html">More Geometry and Trig</a></li><li><a href="explog.html">Exponent Functions and Logarithms</a></li></ul></div><div class="sidebarblock"><h3>Mind-blowing</h3><ul><li><a href="taylor.html">Taylor Series</a></li><li><a href="eulerformula.html">Euler's Formula</a></li></ul></div><div class="sidebarblock"><h3>Other stuff</h3><ul><li><a href="basics.html">The Basics</a></li><li><a href="graphs.html">Graphs</a></li><li><a href="summary.html">Summary</a></li></ul><h3><a href="index.html">Back to front page</a></h3></div></div>
<h1 id="geometry-and-trig">Geometry and Trig<a class="headerlink" href="#geometry-and-trig" title="Link to this title">¶</a></h1><p>This chapter contains useful stuff that aren't too difficult to get started
with. You'll find it especially useful if you like writing games, and this
chapter contains a working example game.</p>

<h2 id="scaling">Scaling<a class="headerlink" href="#scaling" title="Link to this title">¶</a></h2><p>If we multiply all measurements of a shape or picture by a positive number, the
size changes. For example, here the blue triangle is the yellow triangle
<b>scaled up by 2</b>:</p>

<p><img width="408" height="110" class="asymptote" src="asymptote/417a576d7fcc8ced6b0c22c3bdcffb74.svg" /></p><p>Note that angles do not change when scaling. These pictures represent the
bottom-left corners of the above triangles, and as you can see, they are
identical:</p>

<p><img width="281" height="91" class="asymptote" src="asymptote/f14ce26f0ab222969670a6431042ab9d.svg" /></p><p>Scaling with a number less than 1 is known as <b>scaling down</b>, and it makes
things smaller. For example, dividing by 2 is same as multiplying by
$\frac 1 2 = 0.5$, so dividing everything by 2 does this:</p>

<p><img width="261" height="81" class="asymptote" src="asymptote/6248718894c0cb291aaad76722da6584.svg" /></p><h2 id="radians-and-tau">Radians and Tau<a class="headerlink" href="#radians-and-tau" title="Link to this title">¶</a></h2><p>Maybe we could measure angles somehow? A common way to do this is to draw
angles on a circle arc with radius 1. Like this:</p>

<p><img width="283" height="259" class="asymptote" src="asymptote/a9427239d6282537c022a0c43e86b35a.svg" /></p><p>Now we can define the angle as the length of the blue arc. With this
definition, the angle in the picture is about 1 because it looks like the
length of the blue arc is about the same as the radius. This way to measure
angles is known as <b>radians</b>, and the angle in the pic is 1 radian.</p>

<p>Here are more pictures of angles that should help you understand this:</p>

<p><img width="510" height="239" class="asymptote" src="asymptote/3438c9298be5c960b140cd68bb107d18.svg" /></p><p>In this tutorial, the greek tau letter $\tau$ means a full turn in radians:</p>

$$\begin{align}\tau = 6.2831853...\end{align}$$<p>So, if we draw a circle with radius 1, its circumference is $\tau$.</p>

<p><img width="113" height="91" class="asymptote" src="asymptote/ca46c18b4c09975932f25c73646873b6.svg" /></p><p>Some programming languages (e.g. new Pythons) have a <code>tau</code> constant, but if
your favorite language doesn't, use <code>2*pi</code> instead. Here pi is the more
well-known circle constant $\pi = \tau/2 = 3.14159265...$, and almost all
programming languages have something like <code>math.pi</code> or <code>Math.PI</code>.</p>

<p>I find $\tau$ easier to work with than $\pi$ because if I see $\tau/4$ somewhere
I know immediately that it's a quarter turn, but $\pi/2$ isn't as obvious. Of
course, you can use $\pi$ if you prefer it over $\tau$.</p>

<p>If we <a href="#scaling">scale up</a> the above $\tau$ pic by some number $r$, the radius
becomes $1 \cdot r = r$ and the perimeter becomes $\tau r$:</p>

<p><img width="170" height="136" class="asymptote" src="asymptote/0f86213db6feb347f9332ec1aa335053.svg" /></p><p>Now we have something that works with any circle instead of just circles with
radius 1.</p>

<div class="box graybox"><h2> Exercise</h2><p>Use the above $\tau r$ drawing and the below animation to conclude that
$\tau=2\pi$.</p>

<img src="https://upload.wikimedia.org/wikipedia/commons/4/4a/Pi-unrolled_slow.gif" style="max-width: 300px;" /><p><small>The animation comes from
<a href="https://commons.wikimedia.org/wiki/File:Pi-unrolled_slow.gif">here</a>.</small>
</p>

</div><h2 id="degrees">Degrees<a class="headerlink" href="#degrees" title="Link to this title">¶</a></h2><p>Degrees are an alternative to radians, and they work so that 360° is a full
turn. Here ° is the degree symbol, and 360 is a number that people ended up
using for historical reasons.</p>

<p>We already know that 360 degrees is $\tau$ radians, but let's figure out how to
convert $D$ degrees to $R$ radians. One degree is $\frac{1}{360}$ turns, so $D$
degrees is $D \cdot \frac{1}{360}=\frac{D}{360}$ turns. Similarly, $R$ radians
means $\frac R \tau$ turns.</p>

$$\begin{align}\frac{D}{360} &= \frac{R}{\tau}\end{align}$$<p>Multiplying both sides by 360 or $\tau$ gives these:</p>

$$\begin{align}D &= R \cdot 360 / \tau \\
R &= D \cdot \tau / 360\end{align}$$<div class="highlight" style="background: #f0f0f0"><pre style="line-height: 125%"><span></span><span style="color: #007020; font-weight: bold">def</span> <span style="color: #06287e">degrees2radians</span>(degrees):
    <span style="color: #007020; font-weight: bold">return</span> degrees <span style="color: #666666">*</span> math<span style="color: #666666">.</span>tau <span style="color: #666666">/</span> <span style="color: #40a070">360</span>

<span style="color: #007020; font-weight: bold">def</span> <span style="color: #06287e">radians2degrees</span>(radians):
    <span style="color: #007020; font-weight: bold">return</span> radians <span style="color: #666666">*</span> <span style="color: #40a070">360</span> <span style="color: #666666">/</span> math<span style="color: #666666">.</span>tau
</pre></div>
<p>For example, $\frac{90}{360} = \frac 1 4$, so 90° is
$90 \cdot \tau / 360 = \tau\cdot\frac{90}{360} = \frac{\tau}{4}$ radians
(quarter turn).</p>

<p>Some programming languages also have conversion functions like Python's
<code>math.degrees()</code> and <code>math.radians()</code>.</p>

<img src="https://imgs.xkcd.com/comics/degrees.png" style="max-width: 100%;     max-height: 100%;" /><p><small>The comic comes from <a href="https://xkcd.com/1643/">here</a>.</small></p>

<h2 id="coordinates">Coordinates<a class="headerlink" href="#coordinates" title="Link to this title">¶</a></h2><p>Here's a boring number line:</p>

<p><img width="340" height="33" class="asymptote" src="asymptote/bd1a397c230a3efb8173fa564358d791.svg" /></p><p>If we have two number lines called $x$ and $y$, we can do this:</p>

<p><img width="340" height="327" class="asymptote" src="asymptote/737bac56e60a758880d4a0e7f723e7a6.svg" /></p><p>Every point on this plane can be represented with two numbers. These are known
as the $x$ and $y$ <b>coordinates</b>. For example, the $x$ coordinate of the red
point in the below picture is $3$ and the $y$ coordinate is $-2$:</p>

<p><img width="340" height="312" class="asymptote" src="asymptote/a40ec8489a0669c13039889ac83e5cec.svg" /></p><p>Usually $x$ goes before $y$ for historical reasons, so $(3,-2)$ means
$(x,y)=(3,-2)$.</p>

<p id="upside-down-y-axis">So far this probably feels like some useless gibberish that has nothing to do
with real life, but most programming languages have something that works with
coordinates. Usually these coordinates work so that 1 unit represents 1 pixel
on the screen, and the $y$ axis is upside down compared to what mathematicians
are used to. Like this:
</p>

<p><img width="392" height="242" class="asymptote" src="asymptote/5fcc073db3752a9d5baf218870fe8ddf.svg" /></p><div class="box graybox"><h2> Exercise</h2><p>The location of something usually means the top left corner in programming.
Where does the <b>bottom right</b> corner of the window go in this code?</p>

<div class="highlight" style="background: #a9a9a9"><pre style="line-height: 125%"><span></span>window.resize(300, 200);    // (width, height)
window.move_to(600, 500);   // (x, y)
</pre></div>
<p>If this exercise feels difficult, grab a piece of paper and draw a picture
of the whole screen with the window in it.
</p>

</div><h2 id="trig-with-the-unit-circle">Trig with the Unit Circle<a class="headerlink" href="#trig-with-the-unit-circle" title="Link to this title">¶</a></h2><div class="box graybox"><p>This section uses the Greek theta letter $\theta$ because mathematicians
often use it to denote an angle, just like $r$ often denotes a radius. Try
not to get confused; it's just a letter.
</p>

</div><p>Here's a problem that combines <a href="#coordinates">the coordinate stuff</a> with <a href="#radians-and-tau">the
radian stuff</a> above. The unit circle means a circle with
radius 1. Let's draw a unit circle in the center of the xy plane (we'll talk
about other radiuses soon) and draw an angle to it.</p>

<p><img width="340" height="305" class="asymptote" src="asymptote/d85cdb22a34185b9f6c9c071b194ae94.svg" /></p><p>There are quite a few things going on in the above drawing. Make sure you
understand them before moving on.</p>

<p>Now, what are the coordinates of the red dot? Mathematicians have defined a
couple functions just for solving this problem:</p>

$$\begin{align}x &= \cos(\theta) \\
y &= \sin(\theta)\end{align}$$<p>The function names are $\cos$ and $\sin$ for historical reasons. Almost all
programming languages have <code>cos</code> and <code>sin</code> functions, and you don't need to
know how they calculate those values with other functions yet. You just need to
know what $\sin$ and $\cos$ are.</p>

<p>As before, here's a pile of examples:</p>

<img width="254" height="273" class="asymptote" src="asymptote/4f8c1581c9245aebea7dbcdfd8dcebd4.svg" style="float:left;" /><img width="284" height="273" class="asymptote" src="asymptote/7c8dd179867794159d148d015d938f6d.svg" style="float:left;" /><img width="303" height="273" class="asymptote" src="asymptote/a4eefbcaad190b4aeee1999fe1b3cb36.svg" style="float:left;" /><img width="326" height="273" class="asymptote" src="asymptote/b5d4cafe698053456efccb9352814951.svg" style="float:left;" /><img width="256" height="273" class="asymptote" src="asymptote/7db0b501ea321d99b26c55eb363e4761.svg" style="float:left;" /><p><div style="clear:left;"></div></p>

<p>Here $3\tau/4 = \frac 3 4 \tau$ means three quarters of a turn.</p>

<p>You can check these with Python:</p>

<div class="highlight" style="background: #f0f0f0"><pre style="line-height: 125%"><span></span><span style="color: #c65d09; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #007020; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">math</span>
<span style="color: #c65d09; font-weight: bold">&gt;&gt;&gt; </span>math<span style="color: #666666">.</span>sin(math<span style="color: #666666">.</span>tau<span style="color: #666666">/</span><span style="color: #40a070">4</span>)
<span style="color: #888888">1.0</span>
<span style="color: #c65d09; font-weight: bold">&gt;&gt;&gt; </span>math<span style="color: #666666">.</span>cos(math<span style="color: #666666">.</span>tau<span style="color: #666666">/</span><span style="color: #40a070">4</span>)
<span style="color: #888888">6.123233995736766e-17</span>
</pre></div>
<p>Mathemathically $\cos(\tau/4) = 0$, but floats are not mathematically precise
so small errors may occur. In this case, <code>e-17</code> at the end of the number
means that the value we have is 6.12323399... with the dot moved left by 17
places:</p>

$$\begin{align}0.00000000000000006123233995736766\end{align}$$<p>As you can see, this is just a small error.</p>

<p id="parametric-circle">Now it's time to generalize this to circles with a non-1 radius. Let's take
this thing...
</p>

<p><img width="397" height="236" class="asymptote" src="asymptote/d558ecb2363471c82b7e6c106fc5ae32.svg" /></p><p>...and <a href="#scaling">scale it up</a> by $r$:</p>

<p><img width="454" height="273" class="asymptote" src="asymptote/1ad1a8ede1bd0e9d9b514101007292f8.svg" /></p><p>Like I said earlier, angles don't change when scaling, but lengths do. Here
$\theta$ represented an angle <i>and</i> an arc length, so we have the old $\theta$
angle and a scaled $r\theta$ arc length.</p>

<div class="box graybox"><h2> Exercise</h2><p>Let's say that a player of a 2D game should move by 2 pixels every time a
<code>player.move()</code> method is called. It means that the player goes to some
place on the circle with radius 2 around it:</p>

<p><img width="340" height="251" class="asymptote" src="asymptote/d8cf2ac74e5f174df533fb43dc345738.svg" /></p><p>Note how $\theta$ is measured clockwise here but we have measured it
counter-clockwise until now; measuring clockwise is a programming standard
while mathematicians do things counter-clockwise. This means that
everything works nicely with <a href="#upside-down-y-axis">the "upside down" $y$
axis</a>.</p>

<p>Let's say that <code>player.x</code> and <code>player.y</code> are the current coordinates as
floats (they may need to be rounded to ints when actually drawing things),
<code>player.speed == 2</code> and <code>player.angle == θ</code>. Write a <code>player.move()</code>
method using your favorite programming language.
</p>

</div><h2 id="example-ball-and-paddle">Example: Ball and Paddle<a class="headerlink" href="#example-ball-and-paddle" title="Link to this title">¶</a></h2><p>Here's a minimal game written with my <a href="https://github.com/Akuli/math-tutorial/blob/master/canvaswrapper.js">canvaswrapper.js</a> script that
demonstrates most things we have learned so far. Click it, press arrow up to
start the game and then use arrow keys to move the paddle.</p>

<script type="text/javascript" src="canvaswrapper.js"></script><canvas id="canvas1" width="600" height="400" tabindex="1"></canvas><script>var screen = new CanvasWrapper('canvas1');

const TAU = 2*Math.PI;

/* handy things:
    * paddle.centerx - paddle.length/2  x coordinate of left edge
    * paddle.centerx + paddle.length/2  x coordinate of right edge
    * screen.height - paddle.thickness  y coordinate of top edge
    * screen.height                     y coordinate of bottom edge
*/
var paddle = {
  // centerx and top are added later
  length: 200,
  thickness: 15,
  speed: 10,
  movement: 0,    // -1 means left, 1 means right
};

/* handy things:
    * ball.centerx - ball.radius    x coordinate of left edge
    * ball.centerx + ball.radius    x coordinate of right edge
    * ball.centery - ball.radius    y coordinate of top edge
    * ball.centery + ball.radius    y coordinate of bottom edge
*/
var ball = {
  // centerx, centery and angle are added later
  radius: 10,
  speed: 10,
  moving: false,
};

function resetGame() {
  paddle.centerx = screen.width/2;
  ball.centerx = screen.width/2;
  ball.centery = screen.height - paddle.thickness - ball.radius;
  ball.angle = 3*TAU/4;     // up
  ball.moving = false;
}

resetGame();
runRepeatedly(function() {
  screen.fill('black');
  screen.drawRectangle(
    // left x, top y, width, height, color
    paddle.centerx - paddle.length/2, screen.height - paddle.thickness,
    paddle.length, paddle.thickness, '#00ff00');
  screen.drawCircle(ball.centerx, ball.centery, ball.radius, 'white');

  if (ball.moving) {
    if (ball.centery > screen.height) {
      resetGame();
      return;
    }

    ball.centerx += ball.speed * Math.cos(ball.angle);
    ball.centery += ball.speed * Math.sin(ball.angle);

    if (ball.centerx - ball.radius < 0) {     // bumps left wall
      ball.angle = TAU/2 - ball.angle;
      ball.centerx = ball.radius;
    } else if (ball.centerx + ball.radius > screen.width) {   // right wall
      ball.angle = TAU/2 - ball.angle;
      ball.centerx = screen.width - ball.radius;
    } else if (ball.centery - ball.radius < 0) {          // top
      ball.angle = -ball.angle;
      ball.centery = ball.radius;
    } else if (ball.centery + ball.radius > screen.height - paddle.thickness) {
      // paddle?
      paddleLeft = paddle.centerx - paddle.length/2;
      paddleRight = paddle.centerx + paddle.length/2;
      if (paddleLeft < ball.centerx && ball.centerx < paddleRight) {
        // yes, it hits the paddle
        ball.angle = -ball.angle;
        ball.centery = screen.height-paddle.thickness-ball.radius;

        // also adjust the angle depending on which side of the paddle the
        // ball hits
        ball.angle += (ball.centerx - paddle.centerx) / 100;
      }
    }
    paddle.centerx += paddle.movement*paddle.speed;
  }

  screen.getEvents().forEach(evt => {
    if (evt.type == 'keydown') {
      if (ball.moving) {
        if (evt.key == 'ArrowLeft') {
          paddle.movement = -1;
        } else if (evt.key == 'ArrowRight') {
          paddle.movement = 1;
        }
      } else {
        if (evt.key == 'ArrowUp') {
          ball.moving = true;
          return;
        }
      }
    } else if (evt.type == 'keyup' && (
          (evt.key == 'ArrowLeft' && paddle.movement == -1) ||
          (evt.key == 'ArrowRight' && paddle.movement == 1))) {
      // cancel the previous ArrowLeft or ArrowRight press
      paddle.movement = 0;
    }
  });
});
</script><p>Here's the code:</p><div class="highlight" style="background: #f0f0f0"><pre style="line-height: 125%"><span></span><span style="color: #007020; font-weight: bold">var</span> screen <span style="color: #666666">=</span> <span style="color: #007020; font-weight: bold">new</span> CanvasWrapper(<span style="color: #4070a0">&#39;canvas1&#39;</span>);

<span style="color: #007020; font-weight: bold">const</span> TAU <span style="color: #666666">=</span> <span style="color: #40a070">2</span><span style="color: #666666">*</span><span style="color: #007020">Math</span>.PI;

<span style="color: #60a0b0; font-style: italic">/* handy things:</span>
<span style="color: #60a0b0; font-style: italic">    * paddle.centerx - paddle.length/2  x coordinate of left edge</span>
<span style="color: #60a0b0; font-style: italic">    * paddle.centerx + paddle.length/2  x coordinate of right edge</span>
<span style="color: #60a0b0; font-style: italic">    * screen.height - paddle.thickness  y coordinate of top edge</span>
<span style="color: #60a0b0; font-style: italic">    * screen.height                     y coordinate of bottom edge</span>
<span style="color: #60a0b0; font-style: italic">*/</span>
<span style="color: #007020; font-weight: bold">var</span> paddle <span style="color: #666666">=</span> {
  <span style="color: #60a0b0; font-style: italic">// centerx and top are added later</span>
  length<span style="color: #666666">:</span> <span style="color: #40a070">200</span>,
  thickness<span style="color: #666666">:</span> <span style="color: #40a070">15</span>,
  speed<span style="color: #666666">:</span> <span style="color: #40a070">10</span>,
  movement<span style="color: #666666">:</span> <span style="color: #40a070">0</span>,    <span style="color: #60a0b0; font-style: italic">// -1 means left, 1 means right</span>
};

<span style="color: #60a0b0; font-style: italic">/* handy things:</span>
<span style="color: #60a0b0; font-style: italic">    * ball.centerx - ball.radius    x coordinate of left edge</span>
<span style="color: #60a0b0; font-style: italic">    * ball.centerx + ball.radius    x coordinate of right edge</span>
<span style="color: #60a0b0; font-style: italic">    * ball.centery - ball.radius    y coordinate of top edge</span>
<span style="color: #60a0b0; font-style: italic">    * ball.centery + ball.radius    y coordinate of bottom edge</span>
<span style="color: #60a0b0; font-style: italic">*/</span>
<span style="color: #007020; font-weight: bold">var</span> ball <span style="color: #666666">=</span> {
  <span style="color: #60a0b0; font-style: italic">// centerx, centery and angle are added later</span>
  radius<span style="color: #666666">:</span> <span style="color: #40a070">10</span>,
  speed<span style="color: #666666">:</span> <span style="color: #40a070">10</span>,
  moving<span style="color: #666666">:</span> <span style="color: #007020; font-weight: bold">false</span>,
};

<span style="color: #007020; font-weight: bold">function</span> resetGame() {
  paddle.centerx <span style="color: #666666">=</span> screen.width<span style="color: #666666">/</span><span style="color: #40a070">2</span>;
  ball.centerx <span style="color: #666666">=</span> screen.width<span style="color: #666666">/</span><span style="color: #40a070">2</span>;
  ball.centery <span style="color: #666666">=</span> screen.height <span style="color: #666666">-</span> paddle.thickness <span style="color: #666666">-</span> ball.radius;
  ball.angle <span style="color: #666666">=</span> <span style="color: #40a070">3</span><span style="color: #666666">*</span>TAU<span style="color: #666666">/</span><span style="color: #40a070">4</span>;     <span style="color: #60a0b0; font-style: italic">// up</span>
  ball.moving <span style="color: #666666">=</span> <span style="color: #007020; font-weight: bold">false</span>;
}

resetGame();
runRepeatedly(<span style="color: #007020; font-weight: bold">function</span>() {
  screen.fill(<span style="color: #4070a0">&#39;black&#39;</span>);
  screen.drawRectangle(
    <span style="color: #60a0b0; font-style: italic">// left x, top y, width, height, color</span>
    paddle.centerx <span style="color: #666666">-</span> paddle.length<span style="color: #666666">/</span><span style="color: #40a070">2</span>, screen.height <span style="color: #666666">-</span> paddle.thickness,
    paddle.length, paddle.thickness, <span style="color: #4070a0">&#39;#00ff00&#39;</span>);
  screen.drawCircle(ball.centerx, ball.centery, ball.radius, <span style="color: #4070a0">&#39;white&#39;</span>);

  <span style="color: #007020; font-weight: bold">if</span> (ball.moving) {
    <span style="color: #007020; font-weight: bold">if</span> (ball.centery <span style="color: #666666">&gt;</span> screen.height) {
      resetGame();
      <span style="color: #007020; font-weight: bold">return</span>;
    }

    ball.centerx <span style="color: #666666">+=</span> ball.speed <span style="color: #666666">*</span> <span style="color: #007020">Math</span>.cos(ball.angle);
    ball.centery <span style="color: #666666">+=</span> ball.speed <span style="color: #666666">*</span> <span style="color: #007020">Math</span>.sin(ball.angle);

    <span style="color: #007020; font-weight: bold">if</span> (ball.centerx <span style="color: #666666">-</span> ball.radius <span style="color: #666666">&lt;</span> <span style="color: #40a070">0</span>) {     <span style="color: #60a0b0; font-style: italic">// bumps left wall</span>
      ball.angle <span style="color: #666666">=</span> TAU<span style="color: #666666">/</span><span style="color: #40a070">2</span> <span style="color: #666666">-</span> ball.angle;
      ball.centerx <span style="color: #666666">=</span> ball.radius;
    } <span style="color: #007020; font-weight: bold">else</span> <span style="color: #007020; font-weight: bold">if</span> (ball.centerx <span style="color: #666666">+</span> ball.radius <span style="color: #666666">&gt;</span> screen.width) {   <span style="color: #60a0b0; font-style: italic">// right wall</span>
      ball.angle <span style="color: #666666">=</span> TAU<span style="color: #666666">/</span><span style="color: #40a070">2</span> <span style="color: #666666">-</span> ball.angle;
      ball.centerx <span style="color: #666666">=</span> screen.width <span style="color: #666666">-</span> ball.radius;
    } <span style="color: #007020; font-weight: bold">else</span> <span style="color: #007020; font-weight: bold">if</span> (ball.centery <span style="color: #666666">-</span> ball.radius <span style="color: #666666">&lt;</span> <span style="color: #40a070">0</span>) {          <span style="color: #60a0b0; font-style: italic">// top</span>
      ball.angle <span style="color: #666666">=</span> <span style="color: #666666">-</span>ball.angle;
      ball.centery <span style="color: #666666">=</span> ball.radius;
    } <span style="color: #007020; font-weight: bold">else</span> <span style="color: #007020; font-weight: bold">if</span> (ball.centery <span style="color: #666666">+</span> ball.radius <span style="color: #666666">&gt;</span> screen.height <span style="color: #666666">-</span> paddle.thickness) {
      <span style="color: #60a0b0; font-style: italic">// paddle?</span>
      paddleLeft <span style="color: #666666">=</span> paddle.centerx <span style="color: #666666">-</span> paddle.length<span style="color: #666666">/</span><span style="color: #40a070">2</span>;
      paddleRight <span style="color: #666666">=</span> paddle.centerx <span style="color: #666666">+</span> paddle.length<span style="color: #666666">/</span><span style="color: #40a070">2</span>;
      <span style="color: #007020; font-weight: bold">if</span> (paddleLeft <span style="color: #666666">&lt;</span> ball.centerx <span style="color: #666666">&amp;&amp;</span> ball.centerx <span style="color: #666666">&lt;</span> paddleRight) {
        <span style="color: #60a0b0; font-style: italic">// yes, it hits the paddle</span>
        ball.angle <span style="color: #666666">=</span> <span style="color: #666666">-</span>ball.angle;
        ball.centery <span style="color: #666666">=</span> screen.height<span style="color: #666666">-</span>paddle.thickness<span style="color: #666666">-</span>ball.radius;

        <span style="color: #60a0b0; font-style: italic">// also adjust the angle depending on which side of the paddle the</span>
        <span style="color: #60a0b0; font-style: italic">// ball hits</span>
        ball.angle <span style="color: #666666">+=</span> (ball.centerx <span style="color: #666666">-</span> paddle.centerx) <span style="color: #666666">/</span> <span style="color: #40a070">100</span>;
      }
    }
    paddle.centerx <span style="color: #666666">+=</span> paddle.movement<span style="color: #666666">*</span>paddle.speed;
  }

  screen.getEvents().forEach(evt =&gt; {
    <span style="color: #007020; font-weight: bold">if</span> (evt.type <span style="color: #666666">==</span> <span style="color: #4070a0">&#39;keydown&#39;</span>) {
      <span style="color: #007020; font-weight: bold">if</span> (ball.moving) {
        <span style="color: #007020; font-weight: bold">if</span> (evt.key <span style="color: #666666">==</span> <span style="color: #4070a0">&#39;ArrowLeft&#39;</span>) {
          paddle.movement <span style="color: #666666">=</span> <span style="color: #666666">-</span><span style="color: #40a070">1</span>;
        } <span style="color: #007020; font-weight: bold">else</span> <span style="color: #007020; font-weight: bold">if</span> (evt.key <span style="color: #666666">==</span> <span style="color: #4070a0">&#39;ArrowRight&#39;</span>) {
          paddle.movement <span style="color: #666666">=</span> <span style="color: #40a070">1</span>;
        }
      } <span style="color: #007020; font-weight: bold">else</span> {
        <span style="color: #007020; font-weight: bold">if</span> (evt.key <span style="color: #666666">==</span> <span style="color: #4070a0">&#39;ArrowUp&#39;</span>) {
          ball.moving <span style="color: #666666">=</span> <span style="color: #007020; font-weight: bold">true</span>;
          <span style="color: #007020; font-weight: bold">return</span>;
        }
      }
    } <span style="color: #007020; font-weight: bold">else</span> <span style="color: #007020; font-weight: bold">if</span> (evt.type <span style="color: #666666">==</span> <span style="color: #4070a0">&#39;keyup&#39;</span> <span style="color: #666666">&amp;&amp;</span> (
          (evt.key <span style="color: #666666">==</span> <span style="color: #4070a0">&#39;ArrowLeft&#39;</span> <span style="color: #666666">&amp;&amp;</span> paddle.movement <span style="color: #666666">==</span> <span style="color: #666666">-</span><span style="color: #40a070">1</span>) <span style="color: #666666">||</span>
          (evt.key <span style="color: #666666">==</span> <span style="color: #4070a0">&#39;ArrowRight&#39;</span> <span style="color: #666666">&amp;&amp;</span> paddle.movement <span style="color: #666666">==</span> <span style="color: #40a070">1</span>))) {
      <span style="color: #60a0b0; font-style: italic">// cancel the previous ArrowLeft or ArrowRight press</span>
      paddle.movement <span style="color: #666666">=</span> <span style="color: #40a070">0</span>;
    }
  });
});
</pre></div>
<p>&nbsp;</p>

<div class="box graybox"><h2> Exercise</h2><p>A part of my game works similarly to this pseudocode:</p>

<div class="highlight" style="background: #a9a9a9"><pre style="line-height: 125%"><span></span>if (the ball hits the left wall or the right wall) {
    ball.angle = TAU/2 - ball.angle;
}
if (the ball hits the top wall or the paddle) {
    ball.angle = -ball.angle;
}
</pre></div>
<p>Derive these formulas.
</p>

</div></div>
</body>
</html>
