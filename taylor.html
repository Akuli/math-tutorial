<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<link rel="stylesheet" href="style.css">
<title>Taylor Polynomials</title>

<script type="text/x-mathjax-config">
  // awesome, i have javascript inside html inside python
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX", "output/HTML-CSS"],
    tex2jax: {
      inlineMath: [ ['$','$'] ],
      displayMath: [ ['$$','$$'] ],
    },
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js"></script>
</head>
<body>
<div id="content">
<div id="sidebar"><div class="sidebarblock"><h3>Useful</h3><ul><li><a href="derivatives.html">Derivatives</a></li><li><a href="geometry-and-trig.html">Geometry and Trig</a></li><li><a href="numbertheory.html">Number Theory</a></li></ul></div><div class="sidebarblock"><h3>Kinda fun</h3><ul><li><a href="integrals.html">Integrals</a></li><li><a href="more-integrals.html">More Integrals</a></li></ul></div><div class="sidebarblock"><h3>Mathy</h3><ul><li><a href="more-derivatives.html">More Derivatives</a></li><li><a href="more-geometry-and-trig.html">More Geometry and Trig</a></li><li><a href="explog.html">Exponent Functions and Logarithms</a></li></ul></div><div class="sidebarblock"><h3>Mind-blowing</h3><ul><li><b>Taylor Polynomials</b></li><li><a href="eulerformula.html">Euler's Formula</a></li></ul></div><div class="sidebarblock"><h3>Other stuff</h3><ul><li><a href="basics.html">The Basics</a></li><li><a href="graphs.html">Common Graphs</a></li><li><a href="summary.html">Summary</a></li></ul><h3><a href="index.html">Back to front page</a></h3></div></div>
<h1 id="taylor-polynomials">Taylor Polynomials<a class="headerlink" href="#taylor-polynomials" title="Link to this title">¶</a></h1><p>So far we have calculated sine and cosine values with Python.</p>

<div class="highlight" style="background: #f0f0f0"><pre style="line-height: 125%"><span></span><span style="color: #c65d09; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #007020; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">math</span>
<span style="color: #c65d09; font-weight: bold">&gt;&gt;&gt; </span>math<span style="color: #666666">.</span>sin(<span style="color: #40a070">1</span>)
<span style="color: #888888">0.8414709848078965</span>
</pre></div>
<p>In this chapter we'll learn how these functions work, and we'll also write our
own sin and cos implementations that would be good enough for pretty much
everything.</p>

<div class="box redbox"><p>This tutorial uses <a href="geometry-and-trig.html#radians-and-tau">radians</a>,
<a href="geometry-and-trig.html#trig-with-the-unit-circle">unit circle trig</a> and
<a href="derivatives.html">derivatives</a>. Be sure to learn these things first.
</p>

</div><h2 id="wtf-are-taylor-polynomials">WTF are Taylor polynomials?<a class="headerlink" href="#wtf-are-taylor-polynomials" title="Link to this title">¶</a></h2><p>Here are a few graphs:</p>

<p><img width="334" height="340" class="asymptote" src="asymptote/f853e0dfe319a5e47addb750e5f78dec.svg" /></p><p>The red graph is a complicated curve that the other graphs are trying to
approximate.</p>

<p>Let's make some notes based on the graphs:</p>

<ul><li>All graphs have the same height at 0, so $P_0(0)=P_1(0)=P_2(0)=f(0)$.</li><li>$P_1$ and $P_2$ go to the same direction as $f$ at 0, so
  $P_1'(0)=P_2'(0)=f'(0)$.</li><li>This one isn't as obvious as other stuff above, but anyway,
  $P_2''(0)=f''(0)$.
</li></ul><p>Here $f''$ means the derivative of the derivative.</p>

<p>Let's find the equations of $P_0(x)$, $P_1(x)$ and $P_2(x)$. The $P_0$ is easy:</p>

$$\begin{align}
P_0(x) = f(0)
\end{align}$$<p>It's also easy to get started with $P_1$.</p>

$$\begin{align}
P_1'(x) = f'(0) \text{ and } P_1(0) = f(0)
\end{align}$$<p>If you know <a href="integrals.html">integrals</a> you can calculate this yourself. Just
note that $f'(0)$ is a constant because it doesn't depend on the value of $x$.
Anyway, the only $P_1$ that satisfies these things is here:</p>

$$\begin{align}
P_1(x) = f'(0)x + f(0) = f'(0)x + P_0(x)
\end{align}$$<p>Here I used the fact that $P_0(x) = f(0)$. You'll see why later.</p>

<p>Let's find $P_2$ and yet another polynomial $P_3$ similarly:</p>

$$\begin{align}
&P_2''(x) = f''(0) \text{ and } P_2'(0) = f'(0) \text{ and } P_2(0) = f(0) \\
&P_2'(x) = f''(0)x + f'(0) \\
&P_2(x) = \frac{f''(0)}{2}x^2 + f'(0)x + f(0) = \frac{f''(0)}{2}x^2 + P_1(x)\\
\\
&P_3'''(x)=f'''(0)\text{ and }P_3''(0)=f''(0)\text{ and }P_3'(0)=f'(0)\text{ and }P_3(0)=f(0) \\
&P_3''(x)=f'''(0)x+f''(0) \\
&P_3'(x)=\frac{f'''(0)}{2}x^2+f''(0)x+f'(0) \\
&P_3(x)=\frac{f'''(0)}{2\cdot3}x^3+\frac{f''(0)}{2}x^2+f'(0)x+f(0)
= \frac{f'''(0)}{2\cdot3}x^3 + P_2(x)
\end{align}$$<p>So, here are all the results we have gotten so far, written in a way that makes
the pattern quite obvious.</p>

$$\begin{align}
&P_0(x) = f(0) \\
&P_1(x) = P_0(x) + \frac{f'(0)}{1}x \\
&P_2(x) = P_1(x) + \frac{f''(0)}{1 \cdot 2}x^2 \\
&P_3(x) = P_2(x) + \frac{f'''(0)}{1 \cdot 2 \cdot 3}x^3
\end{align}$$<p>Next we'll write the rule for calculating $P_n(x)$ for any $n$, but we need more
notation:</p>

<ul><li>$f^{(n)}(x)$ is the $n$'th derivative of $f$, e.g. $f^{(5)}(x)=f'''''(x)$.</li><li>$n! = 1 \cdot 2 \cdot 3 \cdot ... \cdot n$. Most programming languages have a
  <code>factorial(n)</code> function that returns $n!$.
</li></ul><p>Let's do this.</p>

$$\begin{align}
P_n(x) = f(0) + \frac{f'(0)}{1!}x + \frac{f''(0)}{2!}x^2 + ... + \frac{f^{(n)}(0)}{n!}x^n
\end{align}$$<p>This is known as the $n$'th Taylor polynomial.</p>

<p>We used $x=0$ here as a "magic number" that we always put to $f(\ \ )$, but
that doesn't need to be 0. Here's a more generalized Taylor polynomial:</p>

$$\begin{align}
P_n(x) = f(a) + \frac{f'(a)}{1!}(x-a) + \frac{f''(a)}{2!}(x-a)^2 + ... + \frac{f^{(n)}(a)}{n!}(x-a)^n
\end{align}$$<p>The Taylor polynomial with $a=0$ is also known as a Maclaurin polynomial. You
don't need to remember that in this tutorial, but if someone talks about a
Maclaurin polynomial they mean this.</p>

<p>Taylor polynomials are usually accurate near $a$ and less accurate far from
$a$. These graphs demonstrate that:</p>

<p><img width="255" height="249" class="asymptote" src="asymptote/014cb963c1c1c004fa68b97725d1e6b1.svg" /></p><h2 id="the-magic-sine">The Magic Sine<a class="headerlink" href="#the-magic-sine" title="Link to this title">¶</a></h2><p>This is the real thing. We'll write our own <code>sin(x)</code> function.</p>

<p>We need to know that $\frac{d}{dx} \sin(x) = \cos(x)$ and
$\frac{d}{dx} \cos(x) = -\sin(x)$. These rules are proved
<a href="more-geometry-and-trig.html#derivative-of-sine">here</a>.</p>

<p>So, we get this:</p>

$$\begin{align}
f(x) &= \sin(x) \\
f'(x) &= \cos(x) \\
f''(x) &= -\sin(x) \\
f'''(x) &= -\cos(x) \\
f''''(x) &= \sin(x) \\
f'''''(x) &= \cos(x) \\
f''''''(x) &= -\sin(x) \\
&...
\end{align}$$<p>The pattern is obvious.</p>

<p>Now let's plug in some values. With <a href="summary.html#unitcircle">the unit
circle</a> we know that $\cos 0 = 1$ and
$\sin 0 = 0$ because the $(x,y)$ point $(1,0)$ corresponds to the angle 0.</p>

$$\begin{align}
f(0) &= 0 \\
f'(0) &= 1 \\
f''(0) &= 0 \\
f'''(0) &= -1 \\
f''''(0) &= 0 \\
f'''''(0) &= 1 \\
&...
\end{align}$$<p>So we have this:</p>

$$\begin{align}
\sin(x) &=  f(0) + \frac{f'(0)}{1!}x + \frac{f''(0)}{2!}x^2
            + \frac{f'''(0)}{3!}x^3 + \frac{f''''(0)}{4!}x^4 + ... \\
&=  0 + \frac{1}{1!}x + \frac{0}{2!}x^2 + \frac{-1}{3!}x^3 + \frac{0}{4!}x^4
    + \frac{1}{5!}x^5 + \frac{0}{6!}x^6 + \frac{-1}{7!}x^7 + ... \\
&= x - \frac{x^3}{3!} + \frac{x^5}{5!} - \frac{x^7}{7!} + ...
\end{align}$$<p>That looks quite nice, so let's draw a graph and see if it actually works.</p>

<p><img width="510" height="227" class="asymptote" src="asymptote/f26c6094626a73ed4681b71f46d5eb5b.svg" /></p><p>I think this is just awesome.</p>

<p>Here's our $\sin(x)$ implementation:</p>

<div class="highlight" style="background: #f0f0f0"><pre style="line-height: 125%"><span></span><span style="color: #60a0b0; font-style: italic"># python has math.factorial, but this is here just to show that there&#39;s</span>
<span style="color: #60a0b0; font-style: italic"># no magic involved</span>
<span style="color: #007020; font-weight: bold">def</span> <span style="color: #06287e">factorial</span>(n):
    result <span style="color: #666666">=</span> <span style="color: #40a070">1</span>
    <span style="color: #007020; font-weight: bold">for</span> i <span style="color: #007020; font-weight: bold">in</span> <span style="color: #007020">range</span>(<span style="color: #40a070">1</span>, n<span style="color: #666666">+</span><span style="color: #40a070">1</span>):     <span style="color: #60a0b0; font-style: italic"># 1, 2, ..., n</span>
        result <span style="color: #666666">=</span> result <span style="color: #666666">*</span> i
    <span style="color: #007020; font-weight: bold">return</span> result

<span style="color: #007020; font-weight: bold">def</span> <span style="color: #06287e">taylorsin</span>(x):
    result <span style="color: #666666">=</span> x
    <span style="color: #007020; font-weight: bold">for</span> i <span style="color: #007020; font-weight: bold">in</span> <span style="color: #007020">range</span>(<span style="color: #40a070">3</span>, <span style="color: #40a070">20</span>, <span style="color: #40a070">2</span>):       <span style="color: #60a0b0; font-style: italic"># 3, 5, 7, ..., 19</span>
        thingy <span style="color: #666666">=</span> x<span style="color: #666666">**</span>i<span style="color: #666666">/</span>factorial(i)
        <span style="color: #007020; font-weight: bold">if</span> i <span style="color: #666666">%</span> <span style="color: #40a070">4</span> <span style="color: #666666">==</span> <span style="color: #40a070">3</span>:      <span style="color: #60a0b0; font-style: italic"># 3, 7, 11, ...</span>
            result <span style="color: #666666">-=</span> thingy
        <span style="color: #007020; font-weight: bold">else</span>:
            result <span style="color: #666666">+=</span> thingy
    <span style="color: #007020; font-weight: bold">return</span> result

<span style="color: #007020">print</span>(taylorsin(<span style="color: #40a070">1</span>))     <span style="color: #60a0b0; font-style: italic"># 0.8414709848078965</span>
<span style="color: #007020; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">math</span>
<span style="color: #007020">print</span>(math<span style="color: #666666">.</span>sin(<span style="color: #40a070">1</span>))      <span style="color: #60a0b0; font-style: italic"># also 0.8414709848078965</span>
</pre></div>
<p>I think this is amazing, and the most amazing thing about this is that we got
everything out of basically nothing with just derivatives and antiderivatives.</p>

<p>If you look at how Python's <code>math.sin()</code> is implemented it just calls C
<code>sin()</code>, and that uses taylor polynomials just like our code. The C code is
more complicated than our <code>taylorsin()</code> because it uses taylor polynomials at
other places than $x=0$, but the basic idea is the same.</p>

<p>If we could somehow continue this forever instead of stopping at e.g. <code>i=99</code>
we would get perfectly precise sin values. I'm not going to talk about the
details of why that happens, but this works for sin, cos and many other things.
An infinitely continuing Taylor polynomial is also known as a Taylor <i>series</i>.</p>

<div class="box graybox"><h2> Exercise</h2><p>Find the Taylor series of $\cos(x)$ and $e^x$. See <a href="explog.html#the-e-constant">this
thing</a> if you don't know what $e$ is or what the
derivative of $e^x$ is. Check your answers with your favorite programming
language and <a href="summary.html#series-representations">the Taylor series section</a>
on the summary page.
</p>

</div></div>
</body>
</html>
