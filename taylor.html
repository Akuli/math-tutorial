<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<link rel="stylesheet" href="style.css">
<title>Taylor Series</title>

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX", "output/HTML-CSS"],
    tex2jax: {
      inlineMath: [ ['$','$'] ],
      displayMath: [ ['$$','$$'] ],
    },
    "HTML-CSS": { availableFonts: ["TeX"] },
    TeX: {
      Macros: {
        // awesome, i have latex inside javascript inside html inside python
        // https://xkcd.com/1638/
        red: [ "\\color{red}{#1}", 1 ],
        blue: [ "\\color{blue}{#1}", 1 ],
        green: [ "\\color{green}{#1}", 1 ],
        maroon: [ "\\color{maroon}{#1}", 1 ],
        olive: [ "\\color{olive}{#1}", 1 ],
        purple: [ "\\color{purple}{#1}", 1 ],
        black: [ "\\color{black}{#1}", 1 ],
        rcancel: [ "\\require{cancel}\\red{\\cancel{\\black{#1}}}", 1 ]
      }
    }
  });
</script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js"></script>
<link href="https://fonts.googleapis.com/css?family=Cabin|Quicksand" rel="stylesheet">
</head>
<body>
<div id="content">
<div id="sidebar"><div class="sidebarblock"><h3>Interesting for programmers</h3><ul><li><a href="infinity.html">Infinity</a></li><li><a href="numbertheory.html">Number Theory</a></li><li><a href="fib.html">Fibonacci Sequence</a></li><li><a href="derivatives.html">Derivatives</a></li><li><a href="geometry-and-trig.html">Geometry and Trig</a></li></ul></div><div class="sidebarblock"><h3>Kinda fun</h3><ul><li><a href="integrals.html">Integrals</a></li><li><a href="more-integrals.html">More Integrals</a></li></ul></div><div class="sidebarblock"><h3>Mathy</h3><ul><li><a href="more-derivatives.html">More Derivatives</a></li><li><a href="more-geometry-and-trig.html">More Geometry and Trig</a></li><li><a href="explog.html">Exponent Functions and Logarithms</a></li></ul></div><div class="sidebarblock"><h3>Mind-blowing</h3><ul><li><b>Taylor Series</b></li><li><a href="eulerformula.html">Euler's Formula</a></li></ul></div><div class="sidebarblock"><h3>Other stuff</h3><ul><li><a href="basics.html">The Basics</a></li><li><a href="graphs.html">Graphs</a></li><li><a href="summary.html">Summary</a></li></ul><h3><a href="index.html">Back to front page</a></h3></div></div>
<h1 id="taylor-series">Taylor Series<a class="headerlink" href="#taylor-series" title="Link to this title">¶</a></h1><p>So far we have calculated sine and cosine values with Python.</p>

<div class="highlight" style="background: #f0f0f0"><pre style="line-height: 125%"><span></span><span style="color: #c65d09; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #007020; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">math</span>
<span style="color: #c65d09; font-weight: bold">&gt;&gt;&gt; </span>math<span style="color: #666666">.</span>sin(<span style="color: #40a070">1</span>)
<span style="color: #888888">0.8414709848078965</span>
</pre></div>
<p>In this chapter we'll learn how these functions work, and we'll also write our
own sin and cos implementations that would be good enough for pretty much
everything.</p>

<div class="box redbox"><p>This tutorial uses <a href="geometry-and-trig.html#radians-and-tau">radians</a>,
<a href="geometry-and-trig.html#trig-with-the-unit-circle">unit circle trig</a> and
<a href="derivatives.html">derivatives</a>. Be sure to learn these things first.
</p>

</div><h2 id="polynomials-and-stuff">Polynomials and stuff<a class="headerlink" href="#polynomials-and-stuff" title="Link to this title">¶</a></h2><p>This section introduces a few fancy words that I'll use in the rest of this
chapter. Don't worry, rest of this will be less boring.</p>

<p>Things like $4x^3-5x^2+2x+5$ are known as <b>polynomials</b>. They contain nothing
but constants and powers of $x$ (e.g. $x$, $x^2$, $x^3$) multiplied by
more constants and added together. For example, $-5x^2$ is $x^2$ multiplied by
the constant $-5$. Note that $x^0=1$ and $x^1=x$.</p>

<p>Here are some words related to polynomials:</p>

<ul><li>The <b>degree</b> of a polynomial means the highest power that $x$ is raised to.
  For example, the degree of $4x^3-5x^2+2x+5$ is 3 because the polynomial
  contains $x^3$.</li><li><b>Zeros</b> of a polynomial are $x$ values that make it equal to 0. For
  example, $1^2-1=0$ and $(-1)^2-1=0$, so $x=1$ and $x=-1$ are zeros of
  $x^2-1$.
</li></ul><p>A polynomial of degree $n$ has <b>at most</b> $n$ zeros. For example, we know that
$1$ and $-1$ are two zeros of $x^2-1$, but the degree of $x^2-1$ is 2 so it
cannot have any other zeros. Polynomials can also have less than $n$ zeros; for
example, $x^2$ has just 1 zero at $x=0$ and $x^2+1$ has no zeros at all because
$x^2$ is never less than 0.</p>

<p>The zeros of $f(x)$ can be thought of as places where the graph $y=f(x)$
touches the $x$ axis; that is, $y=0$:</p>

<p><img width="289" height="397" class="asymptote" src="asymptote/b9940a8c43fc76a469f4a5fed748cddb.svg" /></p><p>The word <b>series</b> is a fancy way to say infinitely many things added to each
other. For example, $1+1+1+...$ means that we add infinitely many $1$'s, so it's
a series.</p>

<h2 id="wtf-is-a-taylor-series">WTF is a Taylor series?<a class="headerlink" href="#wtf-is-a-taylor-series" title="Link to this title">¶</a></h2><p>Things like <a href="geometry-and-trig.html#trig-with-the-unit-circle">the sine function</a>
cannot be polynomials because a polynomial of degree $n$ has at most $n$ zeros,
but $\sin(x)$ has infinitely many zeros:</p>

<p><img width="567" height="148" class="asymptote" src="asymptote/b24d98ae24a6db001110837fd8517966.svg" /></p><p>But what if we have an infinite series instead of a polynomial? Then we can
have an infinite number of zeros. So, if $c_0,c_1,c_2,c_3,...$ are constants,
we're talking about finding their values so that we have this:</p>

$$\begin{align}\sin(x)=c_0+c_1x+c_2x^2+c_3x^3+c_4x^4+...\end{align}$$<p>Let's try to find those constants. We'll do this for a general $f(x)$ first,
so we get something that works with many other functions instead of just
$f(x)=\sin(x)$. I'll also use colors to make things easier to follow.</p>

$$\begin{align}f(x)=\blue{c_0}+\green{c_1x}+\maroon{c_2x^2}+\olive{c_3x^3}+\purple{c_4x^4}+...\end{align}$$<p>We can start by plugging in $x=0$:</p>

$$\begin{align}f(0) &= \blue{c_0}+\green{c_1\black{0}}+\maroon{c_2\black{0}^2}+\olive{c_3\black{0}^3}+\purple{c_4\black{0}^4}+... \\
&= \blue{c_0}+0+0+0+... \\
&= \blue{c_0}\end{align}$$<p>Great, we found one constant, but we still have infinitely many constants to
find. So, what do we do next? Let's try taking <a href="derivatives.html">the
derivative</a> of both sides with the $\frac{d}{dx}x^c=cx^{c-1}$
and $\frac{d}{dx}(c\ f(x))=c\cdot\frac{d}{dx}f(x)$ rules.</p>

$$\begin{align}f(x) &= \blue{c_0}+\green{c_1x}+\maroon{c_2x^2}+\olive{c_3x^3}+\purple{c_4x^4}+... \\
f'(x) &= \blue{0}+\green{c_1}+\maroon{2c_2x}+\olive{3c_3x^2}+\purple{4c_4x^3}+... \\
f'(0) &= \green{c_1}\end{align}$$<p>Let's take the derivative again a few times until we can notice a pattern. Here
$f''$ means the derivative of the derivative. It'll look like a mess, but it's
not very complicated.</p>

$$\begin{align}f'(x) &= \green{c_1}+\maroon{2c_2x}+\olive{3c_3x^2}+\purple{4c_4x^3}+\blue{5c_5x^4}+... \\
f''(x) &= \green{0}+\maroon{2c_2}+\olive{(3\cdot2)c_3x}+\purple{(4\cdot3)c_4x^2}+\blue{(5\cdot4)c_5x^3}+... \\
f''(0) &= \maroon{2c_2} \\
\maroon{c_2} &= \frac{f''(0)}{\maroon 2}\end{align}$$$$\begin{align}f''(x) &= \maroon{2c_2}+\olive{(3\cdot2)c_3x}+\purple{(4\cdot3)c_4x^2}+\blue{(5\cdot4)c_5x^3}+\green{(6\cdot5)c_6x^4}+... \\
f'''(x) &= \maroon{0}+\olive{(3\cdot2)c_3}+\purple{(4\cdot3\cdot2)c_4x}+\blue{(5\cdot4\cdot3)c_5x^2}+\green{(6\cdot5\cdot4)c_6x^3}+... \\
f'''(0) &= \olive{(3\cdot2)c_3} \\
\olive{c_3} &= \frac{f'''(0)}{\olive{3\cdot2}}\end{align}$$$$\begin{align}f'''(x) &= \olive{(3\cdot2)c_3}+\purple{(4\cdot3\cdot2)c_4x}+\blue{(5\cdot4\cdot3)c_5x^2}+\green{(6\cdot5\cdot4)c_6x^3}+... \\
f''''(x) &= \olive{0}+\purple{(4\cdot3\cdot2)c_4}+\blue{(5\cdot4\cdot3\cdot2)c_5x}+\green{(6\cdot5\cdot4\cdot3)c_6x^2}+... \\
f''''(0) &= \purple{(4\cdot3\cdot2)c_4} \\
\purple{c_4} &= \frac{f''''(0)}{\purple{4\cdot3\cdot2}}\end{align}$$<p>At this point we need more notation:</p>

<ul><li>$f^{(n)}(x)$ is the $n$'th derivative of $f$, e.g. $f^{(4)}(x)=f''''(x)$.
  You probably agree that $f^{(10)}(x)$ is more readable than $f''''''''''(x)$.</li><li>$n! = n\cdot(n-1)\cdot(n-2)\cdot...\cdot2\cdot1$. As a special case, $0!=1$;
  see <a href="https://www.youtube.com/watch?v=Mfk_L4Nx2ZI">this video</a>. Most
  programming languages have a <code>factorial(n)</code> function that returns $n!$.
</li></ul><p>So far we have noticed that $c_3=\frac{f'''(0)}{3!}$ and
$c_4=\frac{f''''(0)}{4!}$. The values we got for $c_2$, $c_1$ and $c_0$ are also
equal to respectively $\frac{f''(0)}{2!}$, $\frac{f'(0)}{1!}$ and
$\frac{f(0)}{0!}$. Checking them is mostly boring and straight-forward, so I'll
skip that.</p>

<p>If we did more of these we would notice that $c_5=\frac{f^{(5)}(0)}{5!}$,
$c_6=\frac{f^{(6)}(0)}{6!}$ and so on. Our series looks like this:</p>

$$\begin{align}f(x) &= c_0 + c_1x + c_2x^2 + c_3x^3 + c_4x^4 + ... \\
f(x) &= f(0) + \frac{f'(0)}{1!}x + \frac{f''(0)}{2!}x^2 + \frac{f'''(0)}{3!}x^3 + ...\end{align}$$<p>This is known as the <b>Maclaurin series</b> of $f$. Note that factorials get
really big really fast, e.g. $10!$ is bigger than 1 million, so dividing by the
factorials gives us small numbers.</p>

<p>The Maclaurin series uses $0$ as some kind of "magic number" that is always put
to $f(\quad)$, $f'(\quad)$ etc., but it doesn't need to be $0$. By starting
with a constant $a$ and $f(x+a)$ instead of $f(x)$, we can find the
<b>Taylor series</b> of $f$:</p>

$$\begin{align}f(x) = f(a) + \frac{f'(a)}{1!}(x-a) + \frac{f''(a)}{2!}(x-a)^2 + \frac{f''(a)}{3!}(x-a)^3 + ...\end{align}$$<p>Note that the Maclaurin series is just a special case of the Taylor series with
$a=0$.</p>

<h2 id="the-magic-sine">The Magic Sine<a class="headerlink" href="#the-magic-sine" title="Link to this title">¶</a></h2><p>Now we have some scary-looking formulas, but we haven't actually done anything
with them yet. Let's start by plugging in $f(x)=\sin(x)$ and calculating some
derivatives (see <a href="more-geometry-and-trig.html#derivative-of-sine">this thing</a>):</p>

$$\begin{align}f(x) &= \sin(x) \\
f'(x) &= \cos(x) \\
f''(x) &= -\sin(x) \\
f'''(x) &= -\cos(x) \\
f''''(x) &= \sin(x) \\
f'''''(x) &= \cos(x) \\
f''''''(x) &= -\sin(x) \\
&...\end{align}$$<p>Now let's plug in some values. With <a href="geometry-and-trig.html#common-sincos">the unit circle</a>
we know that $\cos(0)=1$ and $\sin(0) = 0$.</p>

$$\begin{align}f(x) &= f(0) + \frac{f'(0)}{1!}x + \frac{f''(0)}{2!}x^2 + \frac{f'''(0)}{3!}x^3 + \frac{f'''(0)}{4!}x^4 + ... \\
\sin(x) &=  \sin(0) + \frac{\cos(0)}{1!}x + \frac{-\sin(0)}{2!}x^2              + \frac{-\cos(0)}{3!}x^3 + \frac{\sin(0)}{4!}x^4 + ... \\
&=  0 + \frac{1}{1!}x + \frac{-0}{2!}x^2 + \frac{-1}{3!}x^3 + \frac{0}{4!}x^4      + \frac{1}{5!}x^5 + \frac{-0}{6!}x^6 + \frac{-1}{7!}x^7 + ... \\
&= x - \frac{x^3}{3!} + \frac{x^5}{5!} - \frac{x^7}{7!} + ...\end{align}$$<p>Just to make sure it works, let's chop off the series at some point and draw a
graph of a part of it.</p>

<p><img width="510" height="240" class="asymptote" src="asymptote/f26c6094626a73ed4681b71f46d5eb5b.svg" /></p><p>The chopped off part is known as the 9th <b>Taylor polynomial</b> of $\sin(x)$
because it's a polynomial of degree 9 and it came from a Taylor series.</p>

<p>Anyway, I think the above graph is just amazing. Here's a working <code>sin(x)</code>
implementation:</p>

<div class="highlight" style="background: #f0f0f0"><pre style="line-height: 125%"><span></span><span style="color: #60a0b0; font-style: italic"># python has math.factorial, but this is here just to show that there&#39;s</span>
<span style="color: #60a0b0; font-style: italic"># no magic involved</span>
<span style="color: #007020; font-weight: bold">def</span> <span style="color: #06287e">factorial</span>(n):
    result <span style="color: #666666">=</span> <span style="color: #40a070">1</span>
    <span style="color: #007020; font-weight: bold">for</span> i <span style="color: #007020; font-weight: bold">in</span> <span style="color: #007020">range</span>(<span style="color: #40a070">1</span>, n<span style="color: #666666">+</span><span style="color: #40a070">1</span>):     <span style="color: #60a0b0; font-style: italic"># 1, 2, ..., n</span>
        result <span style="color: #666666">=</span> result <span style="color: #666666">*</span> i
    <span style="color: #007020; font-weight: bold">return</span> result

<span style="color: #007020; font-weight: bold">def</span> <span style="color: #06287e">maclaurin_sin</span>(x):
    result <span style="color: #666666">=</span> x
    <span style="color: #007020; font-weight: bold">for</span> i <span style="color: #007020; font-weight: bold">in</span> <span style="color: #007020">range</span>(<span style="color: #40a070">3</span>, <span style="color: #40a070">20</span>, <span style="color: #40a070">2</span>):       <span style="color: #60a0b0; font-style: italic"># 3, 5, 7, ..., 19</span>
        thingy <span style="color: #666666">=</span> x<span style="color: #666666">**</span>i<span style="color: #666666">/</span>factorial(i)
        <span style="color: #007020; font-weight: bold">if</span> i <span style="color: #666666">%</span> <span style="color: #40a070">4</span> <span style="color: #666666">==</span> <span style="color: #40a070">3</span>:      <span style="color: #60a0b0; font-style: italic"># 3, 7, 11, ...</span>
            result <span style="color: #666666">-=</span> thingy
        <span style="color: #007020; font-weight: bold">else</span>:
            result <span style="color: #666666">+=</span> thingy
    <span style="color: #007020; font-weight: bold">return</span> result

<span style="color: #007020">print</span>(maclaurin_sin(<span style="color: #40a070">1</span>))     <span style="color: #60a0b0; font-style: italic"># 0.8414709848078965</span>
<span style="color: #007020; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">math</span>
<span style="color: #007020">print</span>(math<span style="color: #666666">.</span>sin(<span style="color: #40a070">1</span>))          <span style="color: #60a0b0; font-style: italic"># also 0.8414709848078965</span>
</pre></div>
<p>If you look at how Python's <code>math.sin()</code> is implemented it just calls C
<code>sin()</code>, and that uses Taylor polynomials just like our code. The C code is
more complicated than our <code>maclaurin_sin()</code> because it uses Taylor polynomials
at other places than $a=0$, but the basic idea is the same.</p>

<p>Let's do something even more amazing! If we notice that the $(x,y)$ point
$(-1,0)$ represents $\pi=\frac{\tau}{2}$ on the unit circle, we can tell that
$\sin(\pi)=0$. However, we can also write that as a series:</p>

$$\begin{align}\pi - \frac{\pi^3}{3!} + \frac{\pi^5}{5!} - \frac{\pi^7}{7!} + ... = 0\end{align}$$<p>So, if someone asks you what $\pi$ is, just tell them that it's the smallest
positive number satisfying that equation.</p>

<p>We can also do the same trick to
$e=\displaystyle\lim_{n\to\infty}\textstyle\left(1+\frac1n\right)^n=2.71828...$
because $\frac{d}{dx}e^x=e^x$. Check out <a href="explog.html#the-e-constant">this thing</a>
if you haven't seen $e$ before.</p>

$$\begin{align}f(x) = e^x,\ f'(x) = e^x,\ f''(x) = e^x,\ f'''(x) = e^x,\ ...\end{align}$$$$\begin{align}e^x &= f(0) + \frac{f'(0)}{1!}x + \frac{f''(0)}{2!}x^2 + \frac{f'''(0)}{3!}x^3 + ... \\
    &= e^0 + \frac{e^0}{1!}x + \frac{e^0}{2!}x^2 + \frac{e^0}{3!}x^3 + ...\end{align}$$<p>This simplifies really nicely because $e^0=1$:</p>

$$\begin{align}e^x &= 1 + \frac{x}{1!} + \frac{x^2}{2!} + \frac{x^3}{3!} + \frac{x^4}{4!} + ...\end{align}$$<p>Just compare this to the series of $\sin(x)$ or $\cos(x)$, it looks very similar
even though $\sin(x)$ is defined with a circle and $e$ has nothing to do with
circles. In fact, it's possible to find an equation with $e$ on one side and
circle stuff on the other side, and there's a detailed introduction to that on
<a href="eulerformula.html">the head explosion zone</a>.</p>

<p>We know that $e^1=e$, so we can also get this by plugging in $x=1$:</p>

$$\begin{align}e &= 1 + \frac{1}{1!} + \frac{1^2}{2!} + \frac{1^3}{3!} + \frac{1^4}{4!} + ... \\
&= 1 + \frac{1}{1} + \frac{1}{2!} + \frac{1}{3!} + \frac{1}{4!} + ... \\
&= 2 + \frac{1}{2!} + \frac{1}{3!} + \frac{1}{4!} + ...\end{align}$$<div class="box graybox"><h2> Exercises</h2><ul><li>What is the derivative of $\sin(x)$? Differentiate the $\sin(x)$ series
  term by term and use it to implement a <code>maclaurin_cos(x)</code> function in
  your favorite programming language.</li><li>Differentiate the $e^x$ series term by term. What do you notice?
</li></ul></div></div>
</body>
</html>
