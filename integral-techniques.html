<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<link rel="stylesheet" href="style.css">
<title>Integration Techniques</title>

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX", "output/HTML-CSS"],
    tex2jax: {
      inlineMath: [ ['$','$'] ],
      displayMath: [ ['$$','$$'] ],
    },
    "HTML-CSS": { availableFonts: ["TeX"] },
    TeX: {
      Macros: {
        // awesome, i have latex inside javascript inside html inside python
        // https://xkcd.com/1638/
        red: [ "\\color{red}{#1}", 1 ],
        blue: [ "\\color{blue}{#1}", 1 ],
        green: [ "\\color{green}{#1}", 1 ],
        maroon: [ "\\color{maroon}{#1}", 1 ],
        olive: [ "\\color{olive}{#1}", 1 ],
        purple: [ "\\color{purple}{#1}", 1 ],
        black: [ "\\color{black}{#1}", 1 ],
        rcancel: [ "\\require{cancel}\\red{\\cancel{\\black{#1}}}", 1],
        implies: [ "\\Rightarrow", 0 ]
      }
    }
  });
</script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js"></script>
<link href="https://fonts.googleapis.com/css?family=Cabin|Quicksand" rel="stylesheet">
</head>
<body>
<div id="content">
<div id="sidebar"><div class="sidebarblock"><h3>Interesting for programmers</h3><ul><li><a href="infinity.html">Infinity</a></li><li><a href="numbertheory.html">Number Theory</a></li><li><a href="fib.html">Fibonacci Sequence</a></li><li><a href="derivatives.html">Derivatives</a></li><li><a href="geometry-and-trig.html">Geometry and Trig</a></li><li><a href="physics.html">Physics Stuff</a></li></ul></div><div class="sidebarblock"><h3>Kinda fun</h3><ul><li><a href="integrals.html">Integrals</a></li><li><b>Integration Techniques</b></li><li><a href="more-integrals.html">More Integrals</a></li></ul></div><div class="sidebarblock"><h3>Mathy</h3><ul><li><a href="more-derivatives.html">More Derivatives</a></li><li><a href="more-geometry-and-trig.html">More Geometry and Trig</a></li><li><a href="explog.html">Exponent Functions and Logarithms</a></li></ul></div><div class="sidebarblock"><h3>Mind-blowing</h3><ul><li><a href="taylor.html">Taylor Series</a></li><li><a href="eulerformula.html">Euler's Formula</a></li></ul></div><div class="sidebarblock"><h3>Other stuff</h3><ul><li><a href="basics.html">Introduction to Math</a></li><li><a href="oldbasics.html">Old Basics Page</a></li><li><a href="graphs.html">Graphs</a></li><li><a href="summary.html">Summary</a></li></ul><h3><a href="index.html">Back to front page</a></h3></div></div>
<h1 id="integration-techniques">Integration Techniques<a class="headerlink" href="#integration-techniques" title="Link to this title">¶</a></h1><div class="box redbox"><p>This chapter assumes that you know <a href="integrals.html">integrals</a> and
<a href="more-geometry-and-trig.html#derivative-of-sine">sine and cosine
derivatives</a>. It also uses
<a href="more-geometry-and-trig.html#sin-sup-2-sup-x">weird trig notation</a>
</p>

</div><p>Nowadays it's easiest to use sympy for doing difficult integrals, but in this
chapter we'll look into how integrals were done before computers and
calculators. It sounds very boring and hard, but you might find especially
u-substitution kind of amazing.</p>

<h2 id="u-substitution">U Substitution<a class="headerlink" href="#u-substitution" title="Link to this title">¶</a></h2><p>In the integral chapter we learned that $\int f(x)\ dx$ means the
antiderivatives of $f$. The notation with $dx$'s in it is known as
<a href="https://en.wikipedia.org/wiki/Gottfried_Wilhelm_Leibniz">Leibniz</a>'s notation,
and I explained the $\int f(x)\ dx$ like Leibniz did. However, the notation
probably wouldn't be used today if the trick I'm about to show wouldn't make it
really handy.</p>

<p>Let's say that $F$ is an antiderivative of $f$; that is, $F'(x)=f(x)$. In the
integral chapter we turned the <a href="derivatives.html#chain-rule">chain rule</a>
into an integral rule by integrating both sides:</p>

$$\begin{align}f(g(x))g'(x) &= \frac{d}{dx}F(g(x)) \\
\int f(g(x))g'(x)\ dx &= F(g(x)) + C\end{align}$$<p>Something interesting happens if we define another variable $u=g(x)$. Then
$\frac{du}{dx}=g'(x)$. You can use whatever variable name you want, but $u$ is
traditionally used here.</p>

$$\begin{align}\int f(u)\frac{du}{dx}\ dx &= F(u) + C\end{align}$$<p>Could we just <i>cancel out</i> the $dx$'s? It feels kind of wrong because the $dx$
is just a part of our antiderivative notation and not really a variable, but
let's try it and see what happens:</p>

$$\begin{align}\int f(u)\frac{du}{\rcancel{dx}}\rcancel{dx} &\mathop{=}^{\text{wat}} F(u) + C \\
\int f(u)\ du\ &\mathop{=}^{\text{lol}}_{\text{srsly?}}\ F(u) + C\end{align}$$<p>Amazing, it really worked! $F(u) + C$ is indeed the integral of $f(u)$ with
respect to $u$.</p>

$$\begin{align}\frac{d}{du}(F(u)+C) \mathop{=}^{\text{yes}} F'(u)+0 \mathop{=}_{\text{srsly}} f(u)\end{align}$$<p>We can get to the same result like this:</p>

$$\begin{align}&   \int f(\green{g(x)})\blue{g'(x)\ dx}  \qquad\qquad \begin{array}{l}      \green u = \green{g(x)} \\
    \frac{du}{dx} = g'(x) \\
    \blue{du} \overset{\text{lol}}= \blue{g'(x)\ dx} \\
\end{array} \\
=&\ \int f(\green u)\ \blue{du} \\
=&\ F(u) + C \\
=&\ F(g(x)) + C\end{align}$$<div class="highlight" style="background: #f0f0f0"><pre style="line-height: 125%"><span></span>&lt;__Myst__&gt;  Akuli: that&#39;s magic
&lt;Akuli&gt;     yes it is :D
&lt;Akuli&gt;     well not really
&lt;Akuli&gt;     you can kind of understand it if you think of du and dx as
            very small changes of u and x
&lt;Akuli&gt;     and ∫f(u)du as a sum of f(u) by du area rectangles
&lt;Akuli&gt;     that&#39;s obviously not a very modern way to define derivatives and
            integrals, but it kind of explain-ishs it
</pre></div>
<p>When our teacher had shown this trick to us for the first time, everyone were
just amazed by it, and the teacher said that he wanted to take a picture of our
faces.</p>

<div class="box graybox"><h2> Example: $\int x\sin(x^2)\ dx$</h2><p>The derivative of $x^2$ is $2x$ and it differs from $x$ by just a constant,
so a substitution like $u=x^2$ will work.</p>

$$\begin{align}\int x\sin(x^2)\ dx &= \int \sin(\green{x^2})\ \blue{x\ dx}  \qquad\qquad \begin{array}{l}      \green u = \green{x^2} \\
    \frac{du}{dx} = 2x \\
    du = 2x\ dx \\
    \blue{x\ dx} = \blue{\frac 1 2 du} \\
\end{array} \\
&= \int\sin(\green u)\blue{\frac 1 2 du} \\
&= \frac 1 2 \int\sin(u)\ du \\
&= \frac 1 2 (-\cos(\green u)) + C \\
&= -\frac 1 2 \cos(\green{x^2}) + C\end{align}$$$$\begin{align}\frac{d}{dx}\left(-\frac 1 2 \cos(x^2) + C\right)  = -\frac 1 2 (-\sin(x^2)) \cdot 2x + 0 = x\sin(x^2)\end{align}$$</div><p>This worked because it's easy to change the integral so that it contains
the derivative of the inside:</p>

$$\begin{align}\int x\sin(x^2)\ dx = \frac 1 2 \int 2x\sin(x^2)\ dx\end{align}$$<p>Treating $du$ and $dx$ as variables like $du=2x\ dx$ is hand-wavy, but it's
very commonly used and accepted hand-waviness because it works so nicely. In
fact, many people write $\int dx$ when they mean $\int 1\ dx$ and
$\int \frac{dx}{f(x)}$ when they mean $\int \frac{1}{f(x)}\ dx$.</p>

<p>Note that in the above example we added another variable, and switched
<b>everything</b> to use that variable instead of $x$; there must be no $x$ left
over. If there is, try another $u$ choice, do something to the function before
integrating it or maybe try some other integration technique instead of $u$
substitution. When we were done, we went from the $u$ world back to the $x$
world.</p>

<div id="story" class="box graybox"><h2> Exercise</h2><p>Here's a true story. At school we had trouble with this integral:</p>

$$\begin{align}\int \frac{\cos(x)}{\sin^2(x)}\ dx\end{align}$$<p>Our supply teacher came up with a solution, and when I saw it I knew it was
very incorrect, aka <b>WRONG</b> in <b>CAPS AND BOLD</b>. It started like this:</p>

$$\begin{align}\int \frac{\cos(x)}{\sin^2(x)}\ dx = \frac{1}{2\sin(x)}\int\frac{2\sin(x)\cos(x)}{\sin^2(x)}\ dx =\ ...\end{align}$$<p>Here the supply teacher wanted to have the derivative of $\sin^2(x)$ on the
top. You should know by now that we <b>cannot</b> bring non-constants like
$\frac{1}{2\sin(x)}$ out of integrals. I argued with the teacher about his
solution for the rest of the lesson.</p>

<div class="highlight" style="background: #a9a9a9"><pre style="line-height: 125%"><span></span>&lt;Zaab1t&gt;    and then everyone clapped
&lt;Akuli&gt;     well, everyone laughed several times
&lt;Akuli&gt;     "this is constant on this interval balblabla"  "NO its a
            function, not a constant"
</pre></div>
<p>The following day our actual teacher thanked me for arguing about it, and
later I found two more fatal mistakes from the solution.</p>

<p>Anyway, integrate $\dfrac{\cos(x)}{\sin^2(x)}$ correctly. It's easy with
the correct substitution. (Note that
<a href="explog.html#exponent-functions">$x^{-a} = 1/x^a$</a>.)
</p>

</div><p>Let's see how this works for definite integral; that is, $\int_a^b$ instead of
$\int$, area instead of antiderivative.</p>

$$\begin{align}\int_a^b f(g(x))g'(x)\ dx &= \bigl[F(g(x))\bigr]_{x=a}^{x=b} \\
&= F(\green{g(b)})-F(\green{g(a)}) \\
&= \bigl[F(\green{u})\bigr]_{u=\green{g(a)}}^{u=\green{g(b)}} \\
&= \int_{g(a)}^{g(b)} f(u)\ du\end{align}$$<p>This means that we just need to change the limits to $u$ values.</p>

<div class="box graybox"><h2> Example: $\int_\sqrt{\tau}^\sqrt{2\tau} x\sin(x^2)\ dx$</h2>$$\begin{align}\int_\sqrt{\tau}^\sqrt{2\tau} x\sin(x^2)\ dx &= \int_\sqrt{\tau}^\sqrt{2\tau} \sin(x^2)\ x\ dx  \qquad\qquad \begin{array}{l}      u = x^2 \\
    \text{if }x=\sqrt{\tau}\text{ then }u=\tau \\
    \text{if }x=\sqrt{2\tau}\text{ then }u=2\tau \\
    du = 2x\ dx \\
    x\ dx = \frac 1 2 du \\
\end{array} \\
&= \int_\tau^{2\tau}\sin(u)\frac 1 2 du \\
&= \frac 1 2 \bigl[-\cos(u)\bigr]_{u=\tau}^{u=2\tau} \\
&= \frac 1 2 (-\cos(2\tau)-(-\cos(\tau))) \\
&= \frac 1 2 (\green{\cos(\tau)-\cos(2\tau)})\end{align}$$<p>$\tau$ and $2\tau$ differ from each other by a full turn, and rotating a
full turn on the unit circle brings us back to where we started and the
cosines are the same.</p>

$$\begin{align}\cos(\tau) &= \cos(2\tau) \\
\green{\cos(\tau)-\cos(2\tau)} &= 0 \\
\int_\sqrt{\tau}^\sqrt{2\tau} x\sin(x^2)\ dx &= 0\end{align}$$</div><p>Note that we didn't need to go back to the $x$ world; with definite integrals
it's enough to change the limits, and then we can forget the whole $x$.</p>

<div class="box graybox"><h2> Exercise</h2><p>The <a href="graphs.html#parabolas">parabola</a> $y=(x-1)^2$ rotates around the $x$
axis between $0 \le x \le 2$. Calculate the volume of the shape it forms.</p>

<img  class="asymptote" src="asymptote/872ff63b52265633a8a8c65ba18c2795.png" style="border: 5px solid white; border-radius: 10px;" /></div><h2 id="trig-substitution">Trig Substitution<a class="headerlink" href="#trig-substitution" title="Link to this title">¶</a></h2><p>Let's say we have an integral like this:</p>

$$\begin{align}\int\sqrt{1-x^2}\ dx\end{align}$$<p>A substitution like $u=1-x^2$ does not work here because the derivative of the
inside is $-2x$. The $-2$ is not a problem, but we have no extra $x$ in the
integral (and obviously we can't just add an $x$ there).</p>

<p><a href="more-geometry-and-trig.html#famous-trig-formula">Here</a> we proved this formula
as an exercise:</p>

$$\begin{align}\sin^2(\theta) + \cos^2(\theta) = 1\end{align}$$<p>We can solve $\cos^2(\theta) = 1-\sin^2(\theta)$. So, wouldn't it be handy if
we had $x=\sin(\theta)$?</p>

$$\begin{align}\newcommand{abs}[1]{\lvert{#1}\rvert} \\
\sqrt{1-(\sin(\theta))^2} = \sqrt{\cos^2(\theta)} = \abs{\cos(\theta)}\end{align}$$<p>We can do this with a substitution $\theta = \arcsin(x)$. Here $\arcsin$ is the
inverse of $\sin$, but it always returns values so that
$-\frac \tau 4 \le \theta \le \frac \tau 4$, denoted with blue in this pic:</p>

<p><img width="199" height="199" class="asymptote" src="asymptote/1b353c06b508379088bae7f98bc8d664.svg" /></p><p>This is because if we know what $\sin(\theta)$ is, there are multiple values
that $\theta$ could be, like the red dot in the image, but we don't have this
problem on a restricted range like $-\frac \tau 4 \le \theta \le \frac \tau 4$.</p>

<p>Anyway, you can see from the pic that the $x$ coordinates are not negative, so
we have $\cos(\theta) \ge 0$. Let's do the integral</p>

$$\begin{align}&\int\sqrt{1-x^2}\ dx  \qquad\qquad \begin{array}{l} \\
    \theta=\arcsin(x) \\
    x=\sin(\theta) \\
    dx = \cos(\theta)\ d\theta \\
    \green{\cos(\theta)} \ge 0 \\
\end{array} \\
=&\ \int\sqrt{1-\sin^2(\theta)}\ \cos(\theta)\ d\theta \\
=&\ \int\sqrt{\cos^2(\theta)}\ \cos(\theta)\ d\theta \\
=&\ \int\abs{\green{\cos(\theta)}}\cos(\theta)\ d\theta \\
=&\ \int\cos^2(\theta)\ d\theta\end{align}$$<p>We still can't use u substitution because we don't have the derivative of
$\cos(\theta)$ anywhere. Let's cheat and use <a href="https://en.wikipedia.org/wiki/List_of_trigonometric_identities#Power-reduction_formulae">Wikipedia's trig formula
list</a>:</p>

$$\begin{align}\cos^2(\theta) = \frac{1+\cos(2\theta)}{2}\end{align}$$<p>We'll learn an easy way to prove formulas like this in <a href="eulerformula.html">the Euler formula
chapter</a>.</p>

$$\begin{align}\int\sqrt{1-x^2}\ dx  = \int\frac{1+\cos(2\theta)}{2}\ d\theta  = \frac 1 2 \int(1+\cos(2\theta))\ d\theta\end{align}$$<p>Rest of this is quite straight-forward, so I don't see any reason to go through
that.</p>

<p>Here's a handy-dandy table of trig substitutions with a positive constant $a$:</p>

<p><table>
<tr><th>If your integral<br />contains this...</th>
    <th>...use this sub...</th>
    <th>...and this trig formula...</th>
    <th>...that comes from here</th></tr>
<tr><td>$\sqrt{a-x^2}$</td>
    <td>$x=\sqrt a \sin(\theta)$</td>
    <td>$\sin^2(\theta)+\cos^2(\theta)=1$</td>
    <td><a href="more-geometry-and-trig.html#famous-trig-formula">this exercise</a></td></tr>
<tr><td>$\sqrt{a+x^2}$</td>
    <td>$x=\sqrt a \tan(\theta)$</td>
    <td>$1+\tan^2(\theta)=\frac{1}{\cos^2(\theta)}$</td>
    <td><a href="more-geometry-and-trig.html#derivative-of-tangent">the tan derivative</a></td></tr>
</table></p>

<div id="circle-area" class="box graybox"><h2> Exercise</h2><p>In <a href="integrals.html#example-circle-area">the integral chapter</a> I showed you
this pic of different ways to prove the circle area $\pi r^2$:</p>

<p><img width="512" height="148" class="asymptote" src="asymptote/6d13ddcb1b3c44f3b6de10c17b678f94.svg" /></p><p>Prove the circle area formula using the <i>first</i> way, the one with the
stupid vertical slices.
</p>

</div></div>
</body>
</html>
